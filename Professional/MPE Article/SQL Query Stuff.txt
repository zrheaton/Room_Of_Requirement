Correction via Justin H. 

DECLARE @MPERuleID INT, @MPERuleRegexID INT



--SET @MPERuleID = 1055609
--SET @MPERuleRegexID = 1000478



USE LogRhythmEMDB



SELECT mper.MPERuleRegexID, mper.MPERuleID, mper.FullName AS "MPE Rule Name", mst.FullName AS "Log Source Type"
FROM dbo.MPERule mper
FULL JOIN dbo.MPERuleToMsgSourceType mpertmst on mper.MPERuleRegexID = mpertmst.MPERuleRegexID
FULL JOIN dbo.MsgSourceType mst ON mpertmst.MsgSourceTypeID = mst.MsgSourceTypeID
WHERE mper.MPERuleRegexID = @MPERuleRegexID OR MPERuleID = @MPERuleID
ORDER BY [Log Source Type]



STEVENS ORIGINAL 

Select a.MPERuleID, b.MPEPolicyID, a.CommonEventID, a.Name

From dbo.MPERule a

Inner Join dbo.DBO.MPERuleToPolicy b

On a.MPERuleID=b.MPERuleID

Where a.CommonEventID = 1034528



MY MONSTER - This works






This takes forever to execute - it seems to follow a de-facto right join and lists out all 644,366 MPE Rules. It took 39 minutes to run. 

SELECT MPERule.MPERuleRegexID, MPERule.MPERuleID
FROM dbo.MPERule
RIGHT JOIN MPERuleToMsgSourceType
ON dbo.MPERuleToMsgSourceType.MPERuleRegexID = MPERuleToMsgSourceType.MPERuleRegexID
AND MPERuleToMsgSourceType.MPERuleRegexID = '1009479'
AND MPERuleToMsgSourceType.MPERuleRegexID NOT LIKE '1000000'  



This is gettig close 
SELECT MPERule.MPERuleRegexID, MPERule.MPERuleID, MPERule.Name
FROM dbo.MPERule
RIGHT JOIN MPERuleToMsgSourceType
ON dbo.MPERule.MPERuleRegexID = MPERuleToMsgSourceType.MPERuleRegexID
AND MPERuleToMsgSourceType.MPERuleRegexID = MPERuleToMsgSourceType.MsgSourceTypeID
-----------------------------------------------

SELECT MPERule.MPERuleRegexID, MPERule.MPERuleID, MPERule.Name, MsgSourceType.FullName
FROM dbo.MPERule
RIGHT JOIN MPERuleToMsgSourceType
ON dbo.MPERule.MPERuleRegexID = MPERuleToMsgSourceType.MPERuleRegexID
AND MPERuleToMsgSourceType.MPERuleRegexID = MPERuleToMsgSourceType.MsgSourceTypeID
INNER JOIN MsgSourceType
ON MPERuleToMsgSourceType.MsgSourceTypeID = MsgSourceType.MsgSourceTypeID
AND MPERuleToMsgSourceType.MPERuleRegexID = '1009479' 

This is even closer...just have to figure out the null values thing. Same thing. Why do these come back as null. 

SELECT MPERule.MPERuleRegexID, MPERule.MPERuleID, MPERule.Name, MsgSourceType.FullName
FROM dbo.MPERule
RIGHT JOIN MPERuleToMsgSourceType
ON dbo.MPERule.MPERuleRegexID = MPERuleToMsgSourceType.MPERuleRegexID
AND MPERuleToMsgSourceType.MPERuleRegexID = MPERuleToMsgSourceType.MsgSourceTypeID
RIGHT JOIN MsgSourceType
ON MPERuleToMsgSourceType.MsgSourceTypeID = MsgSourceType.MsgSourceTypeID
AND MPERule.MPERuleID = '1410489' 
-------------------------------
Interestingly enough...if I do a full join I can see more but it doesn't respect the filtering at all
SELECT MPERule.MPERuleRegexID, MPERule.MPERuleID, MPERule.Name, MsgSourceType.FullName
FROM dbo.MPERule
RIGHT JOIN MPERuleToMsgSourceType
ON dbo.MPERule.MPERuleRegexID = MPERuleToMsgSourceType.MPERuleRegexID
AND MPERuleToMsgSourceType.MPERuleRegexID = MPERuleToMsgSourceType.MsgSourceTypeID
FULL JOIN MsgSourceType
ON MPERuleToMsgSourceType.MsgSourceTypeID = MsgSourceType.MsgSourceTypeID
AND MPERuleToMsgSourceType.MPERuleRegexID = '1009479' 

-------------------
Convert everything to FULL Joins to get rid of that null...this just leaves the filtering issue and the null FullName issue
Why would it do that? It has to be based on how Fullname is linked to one of the other tables. 
How is fullname linked?
Full name is linked on ...it's not linked.
So where to link it? 






SELECT MPERule.MPERuleRegexID, MPERule.MPERuleID, MPERule.Name, MsgSourceType.FullName
FROM dbo.MPERule
FULL JOIN MPERuleToMsgSourceType
ON dbo.MPERule.MPERuleRegexID = MPERuleToMsgSourceType.MPERuleRegexID
AND MPERuleToMsgSourceType.MPERuleRegexID = MPERuleToMsgSourceType.MsgSourceTypeID
FULL JOIN MsgSourceType
ON MPERuleToMsgSourceType.MsgSourceTypeID = MsgSourceType.MsgSourceTypeID
AND MPERuleToMsgSourceType.MPERuleRegexID = '1009479' 















AND MPERuleToMsgSourceType.MPERuleRegexID = '1009479'
AND MPERuleToMsgSourceType.MPERuleRegexID NOT LIKE '1000000'  








AND MPERuleToMsgSourceType.MPERuleRegexID = '1009479' 












NCM TIMESTAMP=3/21/2022 11:45:40 AM EVENT=OPEN ORIGIN=WIN-DTBDU8AUQS0 PROTOCOL=TCP LOCALIP=127.0.0.1 LOCALPORT=8500 REMOTEIP=127.0.0.1 REMOTEPORT=49706 DIRECTION=IN PID=10268 PNAME=consul.exe STATE=ESTABLISHED OPENTIME=3/21/2022 11:45:39 AM -0500 DETAILS=logonusers=WIN-DTBDU8AUQS0\Administrator processusers=WIN-DTBDU8AUQS0\Administrator,Window Manager\DWM-2,Window Manager\DWM-1 netsessionusers=







NCM TIMESTAMP=3/15/2022 9:16:06 PM EVENT=CLOSE ORIGIN=vntdcbog22 PROTOCOL=TCP LOCALIP=10.66.4.137 LOCALPORT=135 REMOTEIP=10.115.87.6 REMOTEPORT=60204 DIRECTION=IN PID=912 PNAME=svchost.exe STATE=ESTABLISHED OPENTIME=3/15/2022 9:15:54 PM -0500 CLOSETIME=3/15/2022 9:16:06 PM -0500 DURATION=0:00:00:11 DETAILS=logonusers=PROTECCION\GCATINO processusers=Window Manager\DWM-5,PROTECCION\GCATINO,Font Driver Host\UMFD-0,Font Driver Host\UMFD-1,Font Driver Host\UMFD-5,Window Manager\DWM-1 netsessionusers=










NCM TIMESTAMP=3/16/2022 2:31:46 AM EVENT=CLOSE ORIGIN=NTAZURE03 PROTOCOL=TCP LOCALIP=172.16.2.6 LOCALPORT=49668 REMOTEIP=172.16.2.51 REMOTEPORT=61298 DIRECTION=IN PID=764 PNAME=lsass.exe STATE=ESTABLISHED OPENTIME=3/16/2022 2:31:29 AM -0500 CLOSETIME=3/16/2022 2:31:45 AM -0500 DURATION=0:00:00:16 DETAILS=logonusers=PROTECCION\CXNIBMADMIN processusers=Window Manager\DWM-5,Font Driver Host\UMFD-0,Font Driver Host\UMFD-1,Font Driver Host\UMFD-5,PROTECCION\CXNIBMADMIN,Window Manager\DWM-1 netsessionusers=



















